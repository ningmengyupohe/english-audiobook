<view class="player-container">
  <!-- é¡¶éƒ¨èƒŒæ™¯ -->
  <view class="header-bg"></view>
  
  <!-- è¿”å›æŒ‰é’® -->
  <view class="back-button" bindtap="goBack">
    <text class="back-icon">â†</text>
  </view>
  
  <!-- æ­Œæ›²å°é¢åŒºåŸŸ -->
  <view class="cover-section">
    <image src="{{currentBook.cover || '/images/covers/default.jpg'}}" class="{{albumCoverClass || 'album-cover'}}" />
    <view class="disc-shadow"></view>
  </view>
  
  <!-- æ­Œæ›²ä¿¡æ¯ -->
  <view class="song-info">
    <text class="song-title">{{currentBook.title || 'æ­Œæ›²æ ‡é¢˜'}}</text>
    <text class="song-artist">{{currentBook.author || 'ä½œè€…'}}</text>
    <text class="song-album">ä¸“è¾‘: {{currentBook.category || 'è‹±è¯­å¬ä¹¦'}}</text>
  </view>
  
  <!-- ä¼˜åŒ–åçš„è¿›åº¦æ¡åŒºåŸŸ -->
  <view class="progress-section">
    <!-- æ—¶é—´æ˜¾ç¤º -->
    <view class="time-display">
      <text class="time-current">{{formatTime(currentTime)}}</text>
      <view class="time-divider">/</view>
      <text class="time-total">{{formatTime(totalTime)}}</text>
    </view>
    
    <!-- è¿›åº¦æ¡å®¹å™¨ -->
    <view class="progress-container">
      <!-- èƒŒæ™¯è½¨é“ -->
      <view class="progress-track-bg"></view>
      
      <!-- ç¼“å†²è¿›åº¦ï¼ˆå¯é€‰ï¼‰ -->
      <view class="progress-buffered" style="width: 85%;"></view>
      
      <!-- å·²æ’­æ”¾è¿›åº¦ -->
      <view class="progress-played {{isSeekingActive ? 'is-seeking' : ''}} {{!isPlaying ? 'is-paused' : ''}}" style="width: {{progress}}%;">
        <view class="progress-played-fill">
          <view class="progress-gradient"></view>
        </view>
        <!-- æ’­æ”¾å¤´ -->
        <view class="progress-knob" 
              bindtouchstart="onProgressTouchStart" 
              bindtouchmove="onProgressTouchMove" 
              bindtouchend="onProgressTouchEnd">
          <view class="knob-core"></view>
          <view class="knob-glow"></view>
        </view>
      </view>
      
      <!-- ç‚¹å‡»åŒºåŸŸ -->
      <view class="progress-touch-area" bindtap="seekProgress"></view>
    </view>
    
    <!-- è¿›åº¦ä¿¡æ¯ -->
    <view class="progress-info">
      <text class="progress-text">{{progress.toFixed(0)}}% æ’­æ”¾</text>
      <text class="chapter-text">ç¬¬ {{currentChapterIndex + 1}}/{{chapters.length}} ç« </text>
    </view>
  </view>
  
  <!-- æ’­æ”¾æ§åˆ¶ -->
  <view class="player-controls">
    <!-- æ’­æ”¾æ¨¡å¼ -->
    <view class="control-item" bindtap="togglePlayMode">
      <view class="control-icon">
        <text class="mode-icon" wx:if="{{playMode === 'order'}}">ğŸ”</text>
        <text class="mode-icon" wx:elif="{{playMode === 'loop'}}">ğŸ”‚</text>
        <text class="mode-icon" wx:elif="{{playMode === 'random'}}">ğŸ”€</text>
      </view>
      <text class="control-text">æ¨¡å¼</text>
    </view>
    
    <!-- ä¸Šä¸€é¦– -->
    <view class="control-item" bindtap="prevTrack">
      <view class="control-icon">â®</view>
      <text class="control-text">ä¸Šä¸€é¦–</text>
    </view>
    
    <!-- æ’­æ”¾/æš‚åœ -->
    <view class="control-item play-pause" bindtap="togglePlay">
      <view class="play-icon-container">
        <text class="play-icon" wx:if="{{isPlaying}}">â¸</text>
        <text class="play-icon" wx:else>â–¶ï¸</text>
      </view>
    </view>
    
    <!-- ä¸‹ä¸€é¦– -->
    <view class="control-item" bindtap="nextTrack">
      <view class="control-icon">â­</view>
      <text class="control-text">ä¸‹ä¸€é¦–</text>
    </view>
    
    <!-- ç»“æŸå­¦ä¹  -->
    <view class="control-item" bindtap="endStudy">
      <view class="control-icon">ğŸ</view>
      <text class="control-text">ç»“æŸå­¦ä¹ </text>
    </view>
  </view>
  
  <!-- éŸ³é‡æ§åˆ¶ -->
  <view class="volume-section" wx:if="{{showVolume}}">
    <view class="volume-icon">ğŸ”Š</view>
    <view class="volume-bar">
      <view class="volume-track"></view>
      <view class="volume-fill" style="width: {{volume * 100}}%;"></view>
      <view class="volume-dot" style="left: {{volume * 100}}%;" 
            bindtouchstart="onVolumeTouchStart" 
            bindtouchmove="onVolumeTouchMove" 
            bindtouchend="onVolumeTouchEnd"></view>
    </view>
  </view>
  
  <!-- åŠŸèƒ½æŒ‰é’® -->
  <view class="action-buttons">
    <view class="action-item" bindtap="toggleFavorite">
      <view class="action-icon {{isFavorite ? 'favorite-active' : ''}}">
        <text wx:if="{{isFavorite}}">â¤ï¸</text>
        <text wx:else>ğŸ¤</text>
      </view>
      <text class="action-text">æ”¶è—</text>
    </view>
    
    <view class="action-item" bindtap="toggleDownload">
      <view class="action-icon {{isDownloaded ? 'download-active' : ''}}">
        <text wx:if="{{isDownloaded}}">ğŸ“¥</text>
        <text wx:else>â¬‡ï¸</text>
      </view>
      <text class="action-text">ä¸‹è½½</text>
    </view>
    
    <view class="action-item" bindtap="toggleSpeed">
      <view class="action-icon">âš¡</view>
      <text class="action-text">{{playbackSpeed}}x</text>
    </view>
    
    <view class="action-item" bindtap="toggleVolume">
      <view class="action-icon">ğŸ”Š</view>
      <text class="action-text">éŸ³é‡</text>
    </view>
  </view>
  
  <!-- ç« èŠ‚åˆ—è¡¨ -->
  <view class="chapter-section">
    <view class="section-header">
      <text class="section-title">ğŸ“– ç« èŠ‚åˆ—è¡¨</text>
      <text class="section-count">{{chapters.length}} ç« èŠ‚</text>
    </view>
    <scroll-view class="chapter-list" scroll-y="true">
      <view class="chapter-item" 
            wx:for="{{chapters}}" 
            wx:key="id"
            data-index="{{index}}"
            bindtap="playChapter">
        <view class="chapter-info">
          <text class="chapter-title">{{item.title}}</text>
          <text class="chapter-duration">{{formatTime(item.duration || 0)}}</text>
        </view>
        <view class="chapter-status">
          <text class="status-icon" wx:if="{{currentChapterIndex === index}}">ğŸ§</text>
          <text class="status-text" wx:if="{{currentChapterIndex === index}}">æ’­æ”¾ä¸­</text>
          <text class="status-text" wx:elif="{{item.isCompleted}}">å·²å®Œæˆ</text>
          <text class="status-text" wx:else>æœªæ’­æ”¾</text>
        </view>
      </view>
    </scroll-view>
  </view>
  
  <!-- å­¦ä¹ ç»Ÿè®¡ -->
  <view class="study-stats" bindtap="showStudyReport">
    <view class="stats-card">
      <view class="stats-header">
        <text class="stats-title">ğŸ“Š æœ¬æ¬¡å­¦ä¹ </text>
        <text class="stats-time">{{formatTime(studyDuration * 60)}}</text>
      </view>
      <view class="stats-content">
        <view class="stat-item">
          <text class="stat-icon">â°</text>
          <text class="stat-value">{{studyDuration}}</text>
          <text class="stat-label">åˆ†é’Ÿ</text>
        </view>
        <view class="stat-item">
          <text class="stat-icon">ğŸ“–</text>
          <text class="stat-value">{{completedChapters}}</text>
          <text class="stat-label">ç« èŠ‚</text>
        </view>
        <view class="stat-item">
          <text class="stat-icon">ğŸ¯</text>
          <text class="stat-value">{{learningProgress}}%</text>
          <text class="stat-label">è¿›åº¦</text>
        </view>
      </view>
    </view>
  </view>
  
  <!-- æ­Œè¯æ˜¾ç¤ºåŒºåŸŸ -->
  <view class="lyrics-section" wx:if="{{showLyrics}}">
    <view class="lyrics-header">
      <text class="lyrics-title">ğŸµ æ­Œè¯</text>
      <text class="lyrics-close" bindtap="toggleLyrics">å…³é—­</text>
    </view>
    <scroll-view class="lyrics-container" scroll-y="true" scroll-into-view="{{currentLyricId}}">
      <view class="lyrics-line" 
            wx:for="{{lyrics}}" 
            wx:key="time"
            id="lyric-{{index}}"
            data-time="{{item.time}}"
            bindtap="seekToLyric">
        <text class="lyric-text {{currentLyricIndex === index ? 'active' : ''}}">{{item.text}}</text>
      </view>
    </scroll-view>
  </view>
</view>